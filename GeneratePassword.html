<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–∞—Ä–æ–ª–µ–π</title>
<style>
:root{
  --bg: #0f1724;
  --card: #111827;
  --accent: #7dd3fc;
  --text: #e6eef8;
  --muted: #98a2b3;
}
*{box-sizing:border-box}
body{
  background: linear-gradient(180deg,#071028 0%, #0f1724 100%);
  color:var(--text);
  font-family: Inter, Roboto, Arial, sans-serif;
  margin:0;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:24px;
}
.wrap{width:100%; max-width:760px}
h1{margin:0 0 12px 0; text-align:center}
.card{
  background: rgba(255,255,255,0.03);
  padding:18px;
  border-radius:12px;
  box-shadow: 0 8px 30px rgba(2,6,23,0.6);
  border: 1px solid rgba(255,255,255,0.03);
}
.output input{
  width:100%;
  padding:14px;
  border-radius:8px;
  border: none;
  background: rgba(255,255,255,0.02);
  color:var(--text);
  font-size:16px;
}
.buttons-row{
  display:flex;
  gap:8px;
  margin-top:8px;
}
button{
  padding:8px 12px;
  border-radius:8px;
  border:none;
  cursor:pointer;
  background: linear-gradient(90deg,var(--accent),#60a5fa);
  color:#022;
  font-weight:600;
}
button:disabled{
  opacity:0.5;
  cursor:not-allowed
}
.controls{margin-top:14px}
.controls label{
  display:block;
  margin-bottom:10px;
  color:var(--muted)
}
.controls input[type="range"]{
  width:100%;
  margin-top:6px
}
.checkboxes{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:6px;
  margin-top:8px
}
.checkboxes label{
  font-size:14px;
  color:var(--text)
}
.meta{
  display:flex;
  justify-content:space-between;
  margin-top:12px;
  color:var(--muted)
}
footer{
  margin-top:12px;
  text-align:center;
  color:var(--muted)
}

/* üì± –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å–∏—è */
@media (max-width: 600px) {
  .buttons-row {
    flex-direction: column;
  }
  .buttons-row button {
    width: 100%;
  }
  .checkboxes {
    grid-template-columns: 1fr;
  }
  .meta {
    flex-direction: column;
    gap: 8px;
    text-align: center;
  }
}
</style>
</head>
<body>
<div class="wrap">
  <h1>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–∞—Ä–æ–ª–µ–π</h1>
  <div class="card">
    <label class="output">
      <input id="password" readonly placeholder="–ù–∞–∂–º–∏—Ç–µ ¬´–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å¬ª">
      <div class="buttons-row">
        <button id="genBtn">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</button>
        <button id="copyBtn" disabled>–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
        <button id="dlBtn" disabled>–°–∫–∞—á–∞—Ç—å</button>
      </div>
    </label>

    <div class="controls">
      <label>–î–ª–∏–Ω–∞: <span id="lenLabel">16</span>
        <input id="length" type="range" min="4" max="64" value="16">
      </label>
      <div class="checkboxes">
        <label><input type="checkbox" id="lower" checked> —Å—Ç—Ä–æ—á–Ω—ã–µ (a‚Äìz)</label>
        <label><input type="checkbox" id="upper" checked> –ü–†–û–ü–ò–°–ù–´–ï (A‚ÄìZ)</label>
        <label><input type="checkbox" id="digits" checked> —Ü–∏—Ñ—Ä—ã (0‚Äì9)</label>
        <label><input type="checkbox" id="symbols"> —Å–∏–º–≤–æ–ª—ã (!@#...)</label>
        <label><input type="checkbox" id="avoid" checked> –∏—Å–∫–ª—é—á–∞—Ç—å –ø–æ—Ö–æ–∂–∏–µ (I, l, 1, O, 0)</label>
        <label><input type="checkbox" id="pronounce"> –ø—Ä–æ–∏–∑–Ω–æ—Å–∏–º—ã–π –ø–∞—Ä–æ–ª—å</label>
      </div>
    </div>

    <div class="meta">
      <div>Entropy: <strong id="entropy">0</strong> –±–∏—Ç</div>
      <div>Strength: <strong id="strength">‚Äî</strong></div>
    </div>
  </div>
  <footer>
    <small>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ ‚Äî –ø–∞—Ä–æ–ª—å –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä.</small>
  </footer>
</div>

<script>
const LOWER = 'abcdefghijklmnopqrstuvwxyz';
const UPPER = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
const DIGITS = '0123456789';
const SYMBOLS = '!@#$%^&*()-_=+[]{};:,.<>/?~';
const AMBIGUOUS = /[Il1O0]/g;
const VOWELS = 'aeiou';
const CONSONANTS = 'bcdfghjklmnpqrstvwxyz';

function generatePassword(opts){
  let pool = '';
  if (opts.lower) pool += LOWER;
  if (opts.upper) pool += UPPER;
  if (opts.digits) pool += DIGITS;
  if (opts.symbols) pool += SYMBOLS;
  if (!pool) return '';
  if (opts.avoid) pool = pool.replace(AMBIGUOUS, '');
  const arr = new Uint32Array(opts.length);
  crypto.getRandomValues(arr);
  return Array.from(arr, x => pool[x % pool.length]).join('');
}

function generatePronounceable(length){
  let out = '';
  let useCons = true;
  for (let i=0;i<length;i++){
    out += useCons
      ? CONSONANTS[Math.floor(Math.random()*CONSONANTS.length)]
      : VOWELS[Math.floor(Math.random()*VOWELS.length)];
    useCons = !useCons;
  }
  return out;
}

function calcEntropyBits(opts){
  let pool = 0;
  if (opts.lower) pool += LOWER.length;
  if (opts.upper) pool += UPPER.length;
  if (opts.digits) pool += DIGITS.length;
  if (opts.symbols) pool += SYMBOLS.length;
  if (opts.avoid){
    let combined = (opts.lower?LOWER:'')+(opts.upper?UPPER:'')+(opts.digits?DIGITS:'')+(opts.symbols?SYMBOLS:'');
    let set = new Set(combined.split(''));
    let ambiguousCount = 0;
    ['I','l','1','O','0'].forEach(ch => { if (set.has(ch)) ambiguousCount++; });
    pool -= ambiguousCount;
  }
  if (pool <= 1) return 0;
  return Math.log2(pool);
}

function strengthLabel(bits){
  if (bits < 28) return '–û—á–µ–Ω—å —Å–ª–∞–±—ã–π';
  if (bits < 36) return '–°–ª–∞–±—ã–π';
  if (bits < 60) return '–°—Ä–µ–¥–Ω–∏–π';
  if (bits < 80) return '–°–∏–ª—å–Ω—ã–π';
  return '–û—á–µ–Ω—å —Å–∏–ª—å–Ω—ã–π';
}

const pwdField = document.getElementById('password');
const lenInput = document.getElementById('length');
const lenLabel = document.getElementById('lenLabel');
const entropyLabel = document.getElementById('entropy');
const strengthLabelEl = document.getElementById('strength');

const checkIds = ['lower','upper','digits','symbols','avoid','pronounce'];
const checks = {};
checkIds.forEach(id => checks[id] = document.getElementById(id));

document.getElementById('genBtn').onclick = () => {
  const opts = {
    length: parseInt(lenInput.value),
    lower: checks.lower.checked,
    upper: checks.upper.checked,
    digits: checks.digits.checked,
    symbols: checks.symbols.checked,
    avoid: checks.avoid.checked
  };
  const pwd = checks.pronounce.checked ? generatePronounceable(opts.length) : generatePassword(opts);
  pwdField.value = pwd;
  document.getElementById('copyBtn').disabled = !pwd;
  document.getElementById('dlBtn').disabled = !pwd;
  const bits = Math.round(calcEntropyBits(opts) * opts.length);
  entropyLabel.textContent = bits;
  strengthLabelEl.textContent = strengthLabel(bits);
};

document.getElementById('copyBtn').onclick = () => {
  navigator.clipboard.writeText(pwdField.value).then(()=> alert('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!'));
};

document.getElementById('dlBtn').onclick = () => {
  const blob = new Blob([pwdField.value], {type: 'text/plain;charset=utf-8'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'password.txt';
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);
};

lenInput.oninput = () => {
  lenLabel.textContent = lenInput.value;
};
</script>
</body>
</html>
